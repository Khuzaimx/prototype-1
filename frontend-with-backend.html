<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ClassAlarm (With Backend)</title>
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#2563eb" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="ClassAlarm" />
    <link rel="apple-touch-icon" href="icon-192.png" />
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-50">
    <div id="root"></div>
    <script type="text/javascript">
      const { useState, useEffect } = React;

      // API Configuration
      const API_BASE_URL = 'http://localhost:8000/api';
      
      // API Helper Functions
      const apiCall = async (endpoint, options = {}) => {
        const url = `${API_BASE_URL}${endpoint}`;
        const token = localStorage.getItem('access_token');
        
        const config = {
          headers: {
            'Content-Type': 'application/json',
            ...(token && { 'Authorization': `Bearer ${token}` }),
          },
          ...options,
        };
        
        try {
          const response = await fetch(url, config);
          const data = await response.json();
          
          if (!response.ok) {
            throw new Error(data.error || data.detail || 'API Error');
          }
          
          return data;
        } catch (error) {
          console.error('API Error:', error);
          throw error;
        }
      };

      // Platform detection and PWA setup
      useEffect(() => {
        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.register('/sw.js')
            .then((registration) => console.log('SW registered'))
            .catch((error) => console.log('SW registration failed'));
        }

        const userAgent = navigator.userAgent.toLowerCase();
        if (userAgent.includes('mobile') || userAgent.includes('android') || userAgent.includes('iphone')) {
          document.body.classList.add('mobile-platform');
        } else if (userAgent.includes('tablet') || userAgent.includes('ipad')) {
          document.body.classList.add('tablet-platform');
        } else {
          document.body.classList.add('desktop-platform');
        }

        if ('ontouchstart' in window || navigator.maxTouchPoints > 0) {
          document.body.classList.add('touch-enabled');
        }
      }, []);

      function AuthScreen({ onLogin }) {
        const [email, setEmail] = useState('');
        const [error, setError] = useState('');
        const [loading, setLoading] = useState(false);

        const handleSubmit = async (e) => {
          e.preventDefault();
          setLoading(true);
          setError('');
          
          try {
            const data = await apiCall('/auth/demo-login/', {
              method: 'POST',
              body: JSON.stringify({ email: email.trim().toLowerCase() }),
            });
            
            localStorage.setItem('access_token', data.tokens.access);
            localStorage.setItem('refresh_token', data.tokens.refresh);
            localStorage.setItem('user', JSON.stringify(data.user));
            
            onLogin(data.user);
          } catch (err) {
            setError(err.message);
          } finally {
            setLoading(false);
          }
        };

        return (
          React.createElement('div', { className: 'min-h-screen flex items-center justify-center px-4' },
            React.createElement('div', { className: 'w-full max-w-sm bg-white rounded-lg shadow p-6 space-y-6' },
              React.createElement('div', { className: 'text-center' },
                React.createElement('h1', { className: 'text-2xl font-bold text-gray-900' }, 'ClassAlarm'),
                React.createElement('p', { className: 'text-sm text-gray-500 mt-2' }, 'Sign in to continue')
              ),
              React.createElement('form', { onSubmit: handleSubmit, className: 'space-y-4' },
                React.createElement('div', null,
                  React.createElement('label', { htmlFor: 'email', className: 'block text-sm font-medium text-gray-700 mb-2' }, 'Email'),
                  React.createElement('input', {
                    id: 'email', type: 'email', value: email, onChange: (e) => setEmail(e.target.value),
                    placeholder: 'student@giki.edu.pk or cr@giki.edu.pk',
                    className: 'w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500',
                    disabled: loading
                  })
                ),
                error && React.createElement('div', { className: 'text-sm text-red-600' }, error),
                React.createElement('button', { 
                  type: 'submit', 
                  className: `w-full px-4 py-2 rounded-md font-medium ${loading ? 'bg-gray-400' : 'bg-blue-600 hover:bg-blue-700'} text-white`,
                  disabled: loading
                }, loading ? 'Signing in...' : 'Continue')
              ),
              React.createElement('div', { className: 'text-xs text-gray-500 text-center' }, 'Only @giki.edu.pk emails allowed')
            )
          )
        );
      }

      function CRPanel({ classes, setClasses }) {
        const [formData, setFormData] = useState({ subject: '', venue: '', date: '', time: '', note: '' });
        const [editingId, setEditingId] = useState(null);
        const [editForm, setEditForm] = useState({ subject: '', venue: '', date: '', time: '', note: '' });
        const [loading, setLoading] = useState(false);
        const [error, setError] = useState('');

        const handleInputChange = (e) => {
          const { name, value } = e.target;
          setFormData(prev => ({ ...prev, [name]: value }));
        };

        const handleSubmit = async (e) => {
          e.preventDefault();
          setLoading(true);
          setError('');
          
          try {
            const data = await apiCall('/classes/', {
              method: 'POST',
              body: JSON.stringify(formData),
            });
            
            setClasses(prev => [data, ...prev]);
            setFormData({ subject: '', venue: '', date: '', time: '', note: '' });
            alert('Class submitted successfully!');
          } catch (err) {
            setError(err.message);
          } finally {
            setLoading(false);
          }
        };

        const handleDelete = async (id) => {
          if (!confirm('Are you sure you want to delete this class?')) return;
          
          try {
            await apiCall(`/classes/${id}/`, { method: 'DELETE' });
            setClasses(prev => prev.filter(c => c.id !== id));
          } catch (err) {
            alert('Error deleting class: ' + err.message);
          }
        };

        const handleEdit = async (id) => {
          try {
            await apiCall(`/classes/${id}/`, {
              method: 'PUT',
              body: JSON.stringify(editForm),
            });
            
            setClasses(prev => prev.map(c => c.id === id ? { ...c, ...editForm } : c));
            setEditingId(null);
            alert('Class updated successfully!');
          } catch (err) {
            alert('Error updating class: ' + err.message);
          }
        };

        return (
          React.createElement('div', { className: 'space-y-8' },
            React.createElement('div', { className: 'bg-white rounded-lg shadow p-6' },
              React.createElement('h2', { className: 'text-xl font-semibold text-gray-900 mb-6' }, 'Submit New Class'),
              error && React.createElement('div', { className: 'mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-600 text-sm' }, error),
              React.createElement('form', { onSubmit: handleSubmit, className: 'space-y-4' },
                React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-4' },
                  React.createElement('div', null,
                    React.createElement('label', { htmlFor: 'subject', className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Subject'),
                    React.createElement('select', {
                      id: 'subject', name: 'subject', value: formData.subject, onChange: handleInputChange, required: true,
                      className: 'w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white focus:outline-none focus:ring-blue-500 focus:border-blue-500',
                      disabled: loading
                    },
                      [
                        '', 'se221', 'cs221', 'ee201', 'math101', 'phy201', 'is301'
                      ].map((opt, idx) => (
                        React.createElement('option', { key: idx, value: opt }, opt === '' ? 'Select subject' : opt.toUpperCase())
                      ))
                    )
                  ),
                  React.createElement('div', null,
                    React.createElement('label', { htmlFor: 'venue', className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Venue'),
                    React.createElement('select', {
                      id: 'venue', name: 'venue', value: formData.venue, onChange: handleInputChange, required: true,
                      className: 'w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white focus:outline-none focus:ring-blue-500 focus:border-blue-500',
                      disabled: loading
                    },
                      [
                        '', 'acb-lh1','acb-lh2','acb-lh3','acb-lh4','acb-lh5','acb-lh6','acb-lh7','fsce-lh1','fsce-lh2'
                      ].map((opt, idx) => (
                        React.createElement('option', { key: idx, value: opt }, opt === '' ? 'Select venue' : opt.toUpperCase())
                      ))
                    )
                  ),
                  React.createElement('div', null,
                    React.createElement('label', { htmlFor: 'date', className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Date'),
                    React.createElement('input', {
                      type: 'date', id: 'date', name: 'date', value: formData.date, onChange: handleInputChange,
                      required: true, className: 'w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500',
                      disabled: loading
                    })
                  ),
                  React.createElement('div', null,
                    React.createElement('label', { htmlFor: 'time', className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Time'),
                    React.createElement('input', {
                      type: 'time', id: 'time', name: 'time', value: formData.time, onChange: handleInputChange,
                      required: true, className: 'w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500',
                      disabled: loading
                    })
                  ),
                  React.createElement('div', { className: 'md:col-span-2' },
                    React.createElement('label', { htmlFor: 'note', className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Note (optional)'),
                    React.createElement('textarea', {
                      id: 'note', name: 'note', value: formData.note, onChange: handleInputChange,
                      rows: 2, placeholder: 'Any extra info for students... (optional)',
                      className: 'w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 resize-y',
                      disabled: loading
                    })
                  )
                ),
                React.createElement('div', { className: 'pt-4' },
                  React.createElement('button', { 
                    type: 'submit', 
                    className: `w-full md:w-auto px-6 py-2 font-medium rounded-md ${loading ? 'bg-gray-400' : 'bg-blue-600 hover:bg-blue-700'} text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors`,
                    disabled: loading
                  }, loading ? 'Submitting...' : 'Submit Class')
                )
              )
            ),
            React.createElement('div', { className: 'bg-white rounded-lg shadow p-6' },
              React.createElement('h2', { className: 'text-xl font-semibold text-gray-900 mb-6' }, 'Submitted Classes'),
              classes.length === 0
                ? React.createElement('p', { className: 'text-gray-500 text-center py-8' }, 'No classes submitted yet.')
                : React.createElement('div', { className: 'space-y-4' },
                    classes.map(classItem => (
                      React.createElement('div', { key: classItem.id, className: 'border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors' },
                        editingId === classItem.id
                          ? React.createElement('div', { className: 'space-y-3' },
                              React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-3' },
                                React.createElement('div', null,
                                  React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Subject'),
                                  React.createElement('select', {
                                    value: editForm.subject, onChange: (e) => setEditForm(prev => ({ ...prev, subject: e.target.value })),
                                    className: 'w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white focus:outline-none focus:ring-blue-500 focus:border-blue-500'
                                  },
                                    ['se221', 'cs221', 'ee201', 'math101', 'phy201', 'is301'].map((opt, idx) => (
                                      React.createElement('option', { key: idx, value: opt }, opt.toUpperCase())
                                    ))
                                  )
                                ),
                                React.createElement('div', null,
                                  React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Venue'),
                                  React.createElement('select', {
                                    value: editForm.venue, onChange: (e) => setEditForm(prev => ({ ...prev, venue: e.target.value })),
                                    className: 'w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white focus:outline-none focus:ring-blue-500 focus:border-blue-500'
                                  },
                                    ['acb-lh1','acb-lh2','acb-lh3','acb-lh4','acb-lh5','acb-lh6','acb-lh7','fsce-lh1','fsce-lh2'].map((opt, idx) => (
                                      React.createElement('option', { key: idx, value: opt }, opt.toUpperCase())
                                    ))
                                  )
                                ),
                                React.createElement('div', null,
                                  React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Date'),
                                  React.createElement('input', {
                                    type: 'date', value: editForm.date, onChange: (e) => setEditForm(prev => ({ ...prev, date: e.target.value })),
                                    className: 'w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500'
                                  })
                                ),
                                React.createElement('div', null,
                                  React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Time'),
                                  React.createElement('input', {
                                    type: 'time', value: editForm.time, onChange: (e) => setEditForm(prev => ({ ...prev, time: e.target.value })),
                                    className: 'w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500'
                                  })
                                )
                              ),
                              React.createElement('div', null,
                                React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Note'),
                                React.createElement('textarea', {
                                  value: editForm.note, onChange: (e) => setEditForm(prev => ({ ...prev, note: e.target.value })),
                                  rows: 2, className: 'w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 resize-y'
                                })
                              ),
                              React.createElement('div', { className: 'flex gap-2' },
                                React.createElement('button', { onClick: () => handleEdit(classItem.id), className: 'px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700' }, 'Save'),
                                React.createElement('button', { onClick: () => setEditingId(null), className: 'px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700' }, 'Cancel')
                              )
                            )
                          : React.createElement('div', { className: 'flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3' },
                              React.createElement('div', { className: 'flex-1' },
                                React.createElement('h3', { className: 'text-lg font-medium text-gray-900' }, classItem.subject),
                                React.createElement('div', { className: 'mt-1 text-sm text-gray-600' },
                                  React.createElement('span', { className: 'inline-flex items-center' }, 'ðŸ“ ', classItem.venue),
                                  React.createElement('span', { className: 'mx-2' }, 'â€¢'),
                                  React.createElement('span', { className: 'inline-flex items-center' }, 'ðŸ“… ', new Date(classItem.date).toLocaleDateString()),
                                  React.createElement('span', { className: 'mx-2' }, 'â€¢'),
                                  React.createElement('span', { className: 'inline-flex items-center' }, 'ðŸ• ', classItem.time)
                                ),
                                classItem.note && React.createElement('div', { className: 'mt-2 text-sm text-gray-500 italic' }, 'Note: ', classItem.note),
                                classItem.attachment_count > 0 && React.createElement('div', { className: 'mt-2 text-sm text-gray-600' }, 'ðŸ“Ž ', classItem.attachment_count, ' attachment(s)')
                              ),
                              React.createElement('div', { className: 'flex items-center gap-2' },
                                React.createElement('button', { 
                                  onClick: () => { setEditingId(classItem.id); setEditForm({ subject: classItem.subject, venue: classItem.venue, date: classItem.date, time: classItem.time, note: classItem.note || '' }); }, 
                                  className: 'px-3 py-1.5 text-sm rounded-md border border-gray-300 hover:bg-gray-50' 
                                }, 'Edit'),
                                React.createElement('button', { onClick: () => handleDelete(classItem.id), className: 'px-3 py-1.5 text-sm rounded-md border border-red-200 text-red-600 hover:bg-red-50' }, 'Delete')
                              )
                            )
                      )
                    ))
                  )
            )
          )
        );
      }

      function StudentPanel({ classes }) {
        const [loading, setLoading] = useState(false);
        const [error, setError] = useState('');

        const pad2 = (n) => (n < 10 ? `0${n}` : `${n}`);
        const nowLocal = new Date();
        const todayStr = `${nowLocal.getFullYear()}-${pad2(nowLocal.getMonth() + 1)}-${pad2(nowLocal.getDate())}`;
        const todaysClasses = (classes || []).filter(c => c.date === todayStr);

        const getCurrentTime = () => new Date().toLocaleTimeString('en-US', { hour12: false, hour: '2-digit', minute: '2-digit' });

        const getTimeUntilClass = (classTime) => {
          const now = new Date();
          const [hours, minutes] = classTime.split(':');
          const classDateTime = new Date();
          classDateTime.setHours(parseInt(hours), parseInt(minutes), 0, 0);
          const diffMs = classDateTime - now;
          const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
          const diffMinutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));
          if (diffMs < 0) return 'Class has ended';
          if (diffHours > 0) return `${diffHours}h ${diffMinutes}m until class`;
          return `${diffMinutes}m until class`;
        };

        return (
          React.createElement('div', { className: 'space-y-6' },
            React.createElement('div', { className: 'bg-white rounded-lg shadow p-6' },
              React.createElement('div', { className: 'flex justify-between items-center' },
                React.createElement('h2', { className: 'text-xl font-semibold text-gray-900' }, "Today's Classes"),
                React.createElement('div', { className: 'text-sm text-gray-600' }, getCurrentTime())
              )
            ),
            React.createElement('div', { className: 'space-y-4' },
              todaysClasses.length === 0
                ? React.createElement('div', { className: 'bg-white rounded-lg shadow p-8 text-center' },
                    React.createElement('p', { className: 'text-gray-500 text-lg' }, 'No classes today!'),
                    React.createElement('p', { className: 'text-gray-400 text-sm mt-2' }, 'Enjoy your free time! ðŸŽ‰')
                  )
                : todaysClasses.map(classItem => (
                    React.createElement('div', { key: classItem.id, className: 'bg-white rounded-lg shadow p-6 hover:shadow-md transition-shadow' },
                      React.createElement('div', { className: 'flex flex-col sm:flex-row sm:items-start sm:justify-between' },
                        React.createElement('div', { className: 'flex-1' },
                          React.createElement('h3', { className: 'text-lg font-semibold text-gray-900 mb-2' }, classItem.subject),
                          React.createElement('div', { className: 'flex flex-col sm:flex-row sm:items-center text-sm text-gray-600 space-y-1 sm:space-y-0 sm:space-x-4' },
                            React.createElement('span', { className: 'inline-flex items-center' }, 'ðŸ“ ', classItem.venue),
                            React.createElement('span', { className: 'inline-flex items-center' }, 'ðŸ• ', classItem.time)
                          ),
                          React.createElement('div', { className: 'mt-3 text-sm text-gray-500' }, getTimeUntilClass(classItem.time)),
                          classItem.note && React.createElement('div', { className: 'mt-2 text-sm text-gray-500 italic' }, 'Note: ', classItem.note),
                          classItem.attachment_count > 0 && React.createElement('div', { className: 'mt-2 text-sm text-gray-600' }, 'ðŸ“Ž ', classItem.attachment_count, ' attachment(s)')
                        ),
                        React.createElement('div', { className: 'mt-4 sm:mt-0 sm:ml-6 space-y-2' },
                          React.createElement('div', { className: 'bg-blue-50 border border-blue-200 rounded-lg p-3 text-center' },
                            React.createElement('div', { className: 'text-blue-600 text-sm font-medium' }, 'â° Alarm set 20 minutes before class'),
                            React.createElement('div', { className: 'text-blue-500 text-xs mt-1' }, (function() {
                              const [hours, minutes] = classItem.time.split(':');
                              const alarmTime = new Date();
                              alarmTime.setHours(parseInt(hours), parseInt(minutes) - 20, 0, 0);
                              return `Alarm at ${alarmTime.toLocaleTimeString('en-US', { hour12: false, hour: '2-digit', minute: '2-digit' })}`;
                            })())
                          )
                        )
                      )
                    )
                  ))
            ),
            todaysClasses.length > 0 && React.createElement('div', { className: 'bg-white rounded-lg shadow p-6' },
              React.createElement('h3', { className: 'text-lg font-semibold text-gray-900 mb-4' }, "Today's Summary"),
              React.createElement('div', { className: 'grid grid-cols-3 gap-4 text-center' },
                React.createElement('div', { className: 'bg-gray-50 rounded-lg p-4' },
                  React.createElement('div', { className: 'text-2xl font-bold text-gray-900' }, todaysClasses.length),
                  React.createElement('div', { className: 'text-sm text-gray-600' }, 'Total')
                ),
                React.createElement('div', { className: 'bg-green-50 rounded-lg p-4' },
                  React.createElement('div', { className: 'text-2xl font-bold text-green-600' }, todaysClasses.filter(c => {
                    const [hours, minutes] = c.time.split(':');
                    const classTime = new Date();
                    classTime.setHours(parseInt(hours), parseInt(minutes), 0, 0);
                    return classTime > new Date();
                  }).length),
                  React.createElement('div', { className: 'text-sm text-green-600' }, 'Upcoming')
                ),
                React.createElement('div', { className: 'bg-blue-50 rounded-lg p-4' },
                  React.createElement('div', { className: 'text-2xl font-bold text-blue-600' }, todaysClasses.filter(c => {
                    const [hours, minutes] = c.time.split(':');
                    const classTime = new Date();
                    classTime.setHours(parseInt(hours), parseInt(minutes), 0, 0);
                    const alarmTime = new Date(classTime.getTime() - 20 * 60 * 1000);
                    return alarmTime > new Date() && classTime > new Date();
                  }).length),
                  React.createElement('div', { className: 'text-sm text-blue-600' }, 'Alarms')
                )
              )
            )
          )
        );
      }

      function App() {
        const [activeTab, setActiveTab] = React.useState('cr');
        const [session, setSession] = React.useState(() => {
          try { 
            const user = localStorage.getItem('user');
            return user ? JSON.parse(user) : null;
          } catch (_) { 
            return null; 
          }
        });
        const [classes, setClasses] = React.useState([]);
        const [loading, setLoading] = React.useState(false);

        // Load classes on component mount
        useEffect(() => {
          if (session) {
            loadClasses();
          }
        }, [session]);

        const loadClasses = async () => {
          setLoading(true);
          try {
            const data = await apiCall('/classes/');
            setClasses(data.results || data);
          } catch (err) {
            console.error('Error loading classes:', err);
            // Fallback to empty array
            setClasses([]);
          } finally {
            setLoading(false);
          }
        };

        const handleLogin = (user) => {
          setSession(user);
          setActiveTab(user.role === 'cr' ? 'cr' : 'student');
        };

        const handleLogout = () => {
          setSession(null);
          localStorage.removeItem('access_token');
          localStorage.removeItem('refresh_token');
          localStorage.removeItem('user');
        };

        return (
          React.createElement('div', { className: 'min-h-screen bg-gray-50' },
            React.createElement('header', { className: 'bg-white shadow-sm border-b' },
              React.createElement('div', { className: 'max-w-7xl mx-auto px-4 sm:px-6 lg:px-8' },
                React.createElement('div', { className: 'flex justify-between items-center h-16' },
                  React.createElement('h1', { className: 'text-2xl font-bold text-gray-900' }, 'ClassAlarm'),
                  React.createElement('div', { className: 'flex items-center gap-3' },
                    session && React.createElement('span', { className: 'text-sm text-gray-600' }, session.email, ' Â· ', session.role.toUpperCase()),
                    session && React.createElement('button', { onClick: handleLogout, className: 'px-3 py-1.5 text-sm rounded-md border border-gray-300 hover:bg-gray-50' }, 'Sign out')
                  )
                )
              )
            ),
            session
              ? React.createElement(React.Fragment, null,
                  React.createElement('div', { className: 'bg-white border-b' },
                    React.createElement('div', { className: 'max-w-7xl mx-auto px-4 sm:px-6 lg:px-8' },
                      React.createElement('nav', { className: 'flex space-x-8' },
                        React.createElement('button', {
                          onClick: () => setActiveTab('cr'), disabled: session.role !== 'cr',
                          className: `py-4 px-1 border-b-2 font-medium text-sm ${activeTab === 'cr' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'} ${session.role !== 'cr' ? 'opacity-50 cursor-not-allowed' : ''}`
                        }, 'Class CR Panel'),
                        React.createElement('button', {
                          onClick: () => setActiveTab('student'),
                          className: `py-4 px-1 border-b-2 font-medium text-sm ${activeTab === 'student' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'}`
                        }, 'Student Panel')
                      )
                    )
                  ),
                  React.createElement('main', { className: 'max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8' },
                    loading && React.createElement('div', { className: 'text-center py-8' }, 'Loading...'),
                    !loading && (session.role === 'cr' && activeTab === 'cr')
                      ? React.createElement(CRPanel, { classes, setClasses })
                      : !loading && React.createElement(StudentPanel, { classes })
                  )
                )
              : React.createElement(AuthScreen, { onLogin: handleLogin })
          )
        );
      }

      const rootElement = document.getElementById('root');
      const root = ReactDOM.createRoot(rootElement);
      root.render(React.createElement(React.StrictMode, null, React.createElement(App)));
    </script>
  </body>
</html>
